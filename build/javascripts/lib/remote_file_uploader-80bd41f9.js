!function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=[].slice;this.RemoteFileUploader=function(){function n(t){return this.el=t,this.onClick=e(this.onClick,this),this.onDrop=e(this.onDrop,this),this.onDragEnd=e(this.onDragEnd,this),this.onDrag=e(this.onDrag,this),this.files=[],window.File&&window.FileReader&&window.FileList&&window.Blob?void 0:!1}return n.UPLOAD_ENDPOINT=null,n.UPLOAD_PARAMS=null,function(){return $.getJSON("http://metalab-website-service.herokuapp.com/signed_url",function(e){return n.UPLOAD_ENDPOINT=e.url,n.UPLOAD_PARAMS=e.multipart_params})}(),n.prototype.render=function(){return this.isRendered?void 0:(this.drop=document.createElement("div"),this.label=document.createElement("label"),this.output=document.createElement("output"),this.list=document.createElement("ul"),this.el.className+=" remote-file-uploader",this.drop.className="remote-file-uploader-dropzone",this.label.className="remote-file-uploader-dropzone-label",this.output.className="remote-file-uploader-output",this.list.className="remote-file-uploader-output-list",this.label.innerHTML="Drag &amp; drop files here to upload",this.output.appendChild(this.list),this.drop.appendChild(this.output),this.el.appendChild(this.label),this.el.appendChild(this.drop),this.drop.addEventListener("drop",this.onDrop,!1),this.drop.addEventListener("drag",this.onDrag,!1),this.drop.addEventListener("dragover",this.onDrag,!1),this.drop.addEventListener("dragend",this.onDragEnd,!1),this.list.addEventListener("click",this.onClick,!1),this.isRendered=!0,this)},n.prototype.upload=function(){var e,n,r,o,s,i=this;for(n=1<=arguments.length?t.call(arguments,0):[],s=[],r=0,o=n.length;o>r;r++)e=n[r],s.push(function(e){var t,n,r,o,s,a;return o=e.size,t=Math.floor(Math.log(o)/Math.log(1e3)),o=(o/Math.pow(1e3,t)).toFixed(0),s="b Kb Mb Gb Tb Pb".split(" ")[t],n=document.createElement("li"),r=document.createElement("progress"),n.className="remote-file-uploader-output-list-item",n.innerHTML='<span class="name">'+e.name.replace(/[<>]/g,"")+'</span>\n<span class="type">'+(e.type||"n/a")+'</span>\n<span class="size">'+o+"</span><span class='units'>"+s+"</span>",r.min=0,r.max=100,r.value=0,r.innerText="0% complete",n.appendChild(r),i.list.appendChild(n),a={listItem:n,progress:r},null!==i.constructor.UPLOAD_ENDPOINT&&null!==i.constructor.UPLOAD_PARAMS?i._send(e,a):void 0}(e));return s},n.prototype._send=function(e,t){var n,r,o,s,i,a=this;n=new FormData,i=this.constructor.UPLOAD_PARAMS;for(r in i)o=i[r],n.append(r,o);return n.append("file",e,e.name),s=new XMLHttpRequest,s.open("POST",this.constructor.UPLOAD_ENDPOINT,!0),s.onload=function(e){var n,r;t.listItem.classList.remove("uploading"),201===s.status?(r=document.createElement("a"),r.href="#",r.className="remove",r.innerText="Remove",n=document.createElement("input"),n.type="hidden",n.name="file[]",n.value=e.target.responseXML.querySelector("Key").textContent,t.listItem.appendChild(r),t.listItem.appendChild(n),t.listItem.classList.add("uploaded")):s.onerror.call(a,e)},s.onerror=function(){t.listItem.classList.remove("uploading"),t.listItem.classList.add("failed")},s.upload.onprogress=function(e){e.lengthComputable&&(t.progress.value=100*(e.loaded/e.total),t.progress.textContent=""+t.progress.value+"%")},t.listItem.classList.add("uploading"),s.send(n)},n.prototype.onDrag=function(e){return e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy",this.drop.classList.add("drag-enter")},n.prototype.onDragEnd=function(){return this.drop.classList.remove("drag-enter")},n.prototype.onDrop=function(e){return e.stopPropagation(),e.preventDefault(),this.drop.classList.remove("drag-enter"),this.upload.apply(this,e.dataTransfer.files)},n.prototype.onClick=function(e){return e.target.classList.contains("remove")?(e.preventDefault(),e.stopPropagation(),e.target.parentNode.parentNode.removeChild(e.target.parentNode)):void 0},n}.call(this)}.call(this);